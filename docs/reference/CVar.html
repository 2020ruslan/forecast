<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>k-fold Cross-Validation applied to an autoregressive model — CVar • forecast</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="k-fold Cross-Validation applied to an autoregressive model — CVar" />

<meta property="og:description" content="CVar computes the errors obtained by applying an autoregressive
modelling function to subsets of the time series y using k-fold
cross-validation as described in Bergmeir, Hyndman and Koo (2015). It also
applies a Ljung-Box test to the residuals. If this test is significant
(see returned pvalue), there is serial correlation in the residuals and the
model can be considered to be underfitting the data. In this case, the
cross-validated errors can underestimate the generalization error and should
not be used." />

<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">forecast</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">8.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="https://github.com/robjhyndman/forecast/raw/master/vignettes/JSS2008.pdf">JSS paper</a>
</li>
<li>
  <a href="../news/index.html">Change Log</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/robjhyndman/forecast">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>k-fold Cross-Validation applied to an autoregressive model</h1>
    <small class="dont-index">Source: <a href='https://github.com/robjhyndman/forecast/blob/master/R/tscv.R'><code>R/tscv.R</code></a></small>
    <div class="hidden name"><code>CVar.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p><code>CVar</code> computes the errors obtained by applying an autoregressive
modelling function to subsets of the time series <code>y</code> using k-fold
cross-validation as described in Bergmeir, Hyndman and Koo (2015). It also
applies a Ljung-Box test to the residuals. If this test is significant
(see returned pvalue), there is serial correlation in the residuals and the
model can be considered to be underfitting the data. In this case, the
cross-validated errors can underestimate the generalization error and should
not be used.</p>
    
    </div>

    <pre class="usage"><span class='fu'>CVar</span>(<span class='no'>y</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>FUN</span> <span class='kw'>=</span> <span class='no'>nnetar</span>, <span class='kw'>cvtrace</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>blocked</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>LBlags</span> <span class='kw'>=</span> <span class='fl'>24</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>y</th>
      <td><p>Univariate time series</p></td>
    </tr>
    <tr>
      <th>k</th>
      <td><p>Number of folds to use for cross-validation.</p></td>
    </tr>
    <tr>
      <th>FUN</th>
      <td><p>Function to fit an autoregressive model. Currently, it only works
with the <code><a href='nnetar.html'>nnetar</a></code> function.</p></td>
    </tr>
    <tr>
      <th>cvtrace</th>
      <td><p>Provide progress information.</p></td>
    </tr>
    <tr>
      <th>blocked</th>
      <td><p>choose folds randomly or as blocks?</p></td>
    </tr>
    <tr>
      <th>LBlags</th>
      <td><p>lags for the Ljung-Box test, defaults to 24, for yearly series can be set to 20</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other arguments are passed to <code>FUN</code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list containing information about the model and accuracy for each
fold, plus other summary information computed across folds.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Bergmeir, C., Hyndman, R.J., Koo, B. (2018) A note on the
validity of cross-validation for evaluating time series prediction.
<em>Computational Statistics &amp; Data Analysis</em>, <b>120</b>, 70-83.
<a href='https://robjhyndman.com/publications/cv-time-series/'>https://robjhyndman.com/publications/cv-time-series/</a>.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='CV.html'>CV</a>, <a href='tsCV.html'>tsCV</a>.</p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='no'>modelcv</span> <span class='kw'>&lt;-</span> <span class='fu'>CVar</span>(<span class='no'>lynx</span>, <span class='kw'>k</span><span class='kw'>=</span><span class='fl'>5</span>, <span class='kw'>lambda</span><span class='kw'>=</span><span class='fl'>0.15</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/print'>print</a></span>(<span class='no'>modelcv</span>)</div><div class='output co'>#&gt; Series: lynx 
#&gt; Call:   CVar(y = lynx, k = 5, lambda = 0.15)
#&gt; 
#&gt; 5-fold cross-validation
#&gt;                   Mean           SD
#&gt; ME        -47.94024811 168.45264852
#&gt; RMSE      941.32651587 312.32265027
#&gt; MAE       590.53751580 186.42613185
#&gt; MPE       -18.38857601  11.25029762
#&gt; MAPE       53.09867080  13.27799759
#&gt; ACF1        0.03351767   0.18600230
#&gt; Theil's U   0.74429498   0.09406432
#&gt; 
#&gt; p-value of Ljung-Box test of residuals is  0.7000251 
#&gt; if this value is significant (&lt;0.05),
#&gt; the result of the cross-validation should not be used
#&gt; as the model is underfitting the data.</div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/print'>print</a></span>(<span class='no'>modelcv</span>$<span class='no'>fold1</span>)</div><div class='output co'>#&gt; $model
#&gt; Series: y 
#&gt; Model:  NNAR(11,6) 
#&gt; Call:   FUN(y = y, lambda = 0.15, subset = trainset)
#&gt; 
#&gt; Average of 20 networks, each of which is
#&gt; a 11-6-1 network with 79 weights
#&gt; options were - linear output units 
#&gt; 
#&gt; sigma^2 estimated as 0.09849
#&gt; 
#&gt; $accuracy
#&gt;               ME     RMSE      MAE       MPE     MAPE      ACF1 Theil's U
#&gt; Test set 54.5283 669.1654 393.0634 -28.47463 53.24511 0.1040563 0.6553205
#&gt; 
#&gt; $testfit
#&gt; Time Series:
#&gt; Start = 1821 
#&gt; End = 1934 
#&gt; Frequency = 1 
#&gt;   [1]         NA         NA         NA         NA         NA         NA
#&gt;   [7]         NA         NA         NA         NA         NA  105.21504
#&gt;  [13]  173.53080  286.81383  427.76973 2237.13163 2757.61403 3238.53147
#&gt;  [19] 3444.50705  513.36004  156.14849   46.60305   69.77331  205.89523
#&gt;  [25]  534.67536 1045.54882 2166.50062 2809.28424  964.44677  352.69546
#&gt;  [31]  355.51756  242.29041  348.68280  745.43335 1287.35967 2906.52296
#&gt;  [37] 3047.12261 1845.34837  715.91621  194.66933  257.27823  217.94619
#&gt;  [43]  445.70225 1513.70832 3199.27674 6176.38809 4333.43277  719.76326
#&gt;  [49]  176.42534  418.40068  360.08275  487.32443 1591.68267 1767.98777
#&gt;  [55] 2327.85152 1477.34294  739.16119  294.98107  203.57957  226.52017
#&gt;  [61]  180.21405  941.25544 1943.38268 3014.77741 4223.73641 4575.36955
#&gt;  [67]  419.77833  180.02903   39.17359   52.26742   63.24813  184.93638
#&gt;  [73]  405.95237  614.39117 3742.22197 3384.20758  587.25797  104.19192
#&gt;  [79]  158.04398  141.19296  751.69124 1316.49408 3356.31448 6748.68018
#&gt;  [85] 6171.41779 3721.28521 1737.52499  365.17075  376.97026  815.86490
#&gt;  [91] 1354.86611 2745.67193 3713.46794 3042.56180 3087.87837 3692.32603
#&gt;  [97]  689.80358   81.77819  120.49390  107.47938  220.57929  431.06549
#&gt; [103] 1133.61505 2435.64993 3405.33786 3039.67200  743.28852  520.01698
#&gt; [109]  452.49698  663.33892 1028.01775 1588.04980 2667.86157 3455.24028
#&gt; 
#&gt; $testset
#&gt;  [1]   3   5   8  10  19  20  35  38  39  40  43  49  52  55  61  62  66  68  74
#&gt; [20]  80  99 107 110
#&gt; </div><div class='input'>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>ggplot2</span>)
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/autoplot.html'>autoplot</a></span>(<span class='no'>lynx</span>, <span class='kw'>series</span><span class='kw'>=</span><span class='st'>"Data"</span>) +
  <span class='fu'><a href='autolayer.html'>autolayer</a></span>(<span class='no'>modelcv</span>$<span class='no'>testfit</span>, <span class='kw'>series</span><span class='kw'>=</span><span class='st'>"Fits"</span>) +
  <span class='fu'><a href='autolayer.html'>autolayer</a></span>(<span class='no'>modelcv</span>$<span class='no'>residuals</span>, <span class='kw'>series</span><span class='kw'>=</span><span class='st'>"Residuals"</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Removed 11 rows containing missing values (geom_path).</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Removed 11 rows containing missing values (geom_path).</span></div><div class='img'><img src='CVar-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='autoplot.acf.html'>ggAcf</a></span>(<span class='no'>modelcv</span>$<span class='no'>residuals</span>)</div><div class='img'><img src='CVar-2.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Gabriel Caceres and Rob J Hyndman</p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by <a href='http://robjhyndman.com'>Rob Hyndman</a>, George Athanasopoulos, <a href='https://github.com/cbergmeir'>Christoph Bergmeir</a>, <a href='https://github.com/gabrielcaceres'>Gabriel Caceres</a>, Leanne Chhay, <a href='https://github.com/mitchelloharawild'>Mitchell O'Hara-Wild</a>, <a href='http://fpetropoulos.eu'>Fotios Petropoulos</a>, <a href='https://github.com/slavarazbash'>Slava Razbash</a>, <a href='http://earo.me'>Earo Wang</a>, Farah Yasmeen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9000.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

